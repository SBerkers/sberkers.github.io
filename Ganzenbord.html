<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Pixelbord</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.5/css/bulma.min.css">
    <style>
        span.dice {
            font-size: 6rem
        }
       
    </style>

    <script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>

    <script>
        
        var vSpeed = 2000
        var vbThrow;
        var vbStartGame;
        var vbStopGame;
        var vdDice1;
        var vdDice2;
        var vMoreGooses =0;
        document.onreadystatechange = fOnPageLoad;
        var vThrowSum = 0;
        var vPosPlayer1 = 0;
        var vPosPlayer2 = 0;
        var vPlayer1 = "Speler 1";
        var vPlayer2 = "Speler 2";
        var vpNarrator;
        var vWhichPlayer;
        var vdPlayer1;
        var vdPlayer2;

        function fOnPageLoad() {

            vbThrow = document.getElementById('bThrow');
            vbStartGame = document.getElementById('bStartGame');
            vbStopGame = document.getElementById('bStopGame');
            vpNarrator = document.getElementById('pTextStart');
            vdDice1 = document.getElementById('dDice1');
            vdDice2 = document.getElementById('dDice2');
       
            vdPlayer1 = document.getElementById('dPlayer1');
            vdPlayer2 = document.getElementById('dPlayer2');
            viPixel = document.getElementById('iPixel');


            vbThrow.style.visibility = 'hidden';
            vbStopGame.style.visibility = 'hidden';
            viPixel.style.visibility = 'hidden';

        }


        function fStartGame() {

            vWhichPlayer = vPlayer1
            vbThrow.style.visibility = 'visible'
            vbStartGame.style.visibility = 'hidden'
            vbStopGame.style.visibility = 'visible'
            vpNarrator.innerHTML = vWhichPlayer + " is aan de beurt"

        }

        function fStopGame() {
            vWhichPlayer = vPlayer1;
            vbThrow.style.visibility = 'hidden';
            vbStartGame.style.visibility = 'visible';
            vbStopGame.style.visibility = 'hidden';
            vbStopGame.innerHTML = "Spel Stoppen"
            vpNarrator.innerHTML = "Druk op Start Spel om te beginnen."
            vPosPlayer1 = 0;
            vPosPlayer2 = 0;
            vdPlayer1.innerHTML = 0;
            vdPlayer2.innerHTML = 0;
            vdDice1.innerHTML = "";
            vdDice2.innerHTML = "";
            totalThrown.innerHTML = "";


        }

        function fThrowDice() {
            vbThrow.disabled = true
            vbStopGame.disabled = true
            var vThrow1 = Math.floor(Math.random() * 6) + 1;
            //var vThrow1=4
            var vDice1 = vThrow1 - 1;
            var vThrow2 = Math.floor(Math.random() * 6) + 1;
            //var vThrow2 = 5
            var vDice2 = vThrow2 - 1;
            vThrowSum = parseInt(vThrow1) + parseInt(vThrow2);

          
            vdDice1.innerHTML = "&#x268" + vDice1.toString() + ";";
            vdDice2.innerHTML = "&#x268" + vDice2.toString() + ";";

            setTimeout(fPositionGoose(vThrowSum), vSpeed/10)

        }

        function fPositionGoose(nPlaces) {

            if (vWhichPlayer == vPlayer1) {

                vPosPlayer1 = vPosPlayer1 + nPlaces;
                fAnimateValue(vdPlayer1, vPosPlayer1 - nPlaces, vPosPlayer1, vSpeed)
                setTimeout(function () {
                    fApplyRules(vPosPlayer1);
                }, vSpeed*1.1)

            }
            else if (vWhichPlayer == vPlayer2) {

                vPosPlayer2 = vPosPlayer2 + nPlaces;
                fAnimateValue(vdPlayer2, vPosPlayer2 - nPlaces, vPosPlayer2, vSpeed)
                setTimeout(function () {
                    fApplyRules(vPosPlayer2);
                }, vSpeed*1.1)
            }
            else return
        }
        function fAnimateValue(player, start, end, duration) {
            if (end > 63) {
                end = 63
            }
            var range = end - start;
            var current = start;
            var increment = end > start ? 1 : -1;
            var stepTime = Math.abs(Math.floor(duration / range));
            var obj = player;
            var timer = setInterval(function () {
                if (current > 63) {
                    obj.innerHTML = 63;
                    current += increment;
                }
                else {
                    current += increment;
                    obj.innerHTML = current;
                }
                if (current == end) {
                    clearInterval(timer);
                }

            }, stepTime);
            return
        }





        function fApplyRules(xPosition) {
            
            switch (xPosition) {
                case 5:
                case 14:
                case 18:
                case 23:
                case 27:
                case 32:
                case 36:
                case 41:
                case 45:
                case 50:
                case 54:
                case 59:
                
                    fLittleGoose()
                            
                break;

                case 63:
                    vpNarrator.innerHTML = vWhichPlayer + " heeft gewonnen!";
                    vbStopGame.innerHTML = "Opnieuw Beginnen";
                    vbStopGame.disabled = false;
                    vbThrow.disabled = false;
                    vMoreGooses=0;
                    viPixel.style.visibility = 'hidden';
                    break;

                case 64:
                case 65:
                case 66:
                case 67:
                case 68:
                case 69:
                case 70:
                case 71:
                case 72:
                case 73:
                case 74:
                    var vPlacesBack = ((xPosition - 63) * -2)
                    fPositionGoose(vPlacesBack)
                    break;


                default:
                    console.log("In Default Switch")
                    vMoreGooses=0;
                    setTimeout(fChangePlayer, vSpeed/2);
                    viPixel.style.visibility = 'hidden';
            }
        }
        
        function fLittleGoose(){
            if(vMoreGooses==0){
            vpNarrator.innerHTML = "Je bent op een Pixel gekomen, je gaat nogmaals " + vThrowSum + " vooruit.";
            }
            else if (vMoreGooses>0){
            vpNarrator.innerHTML = "Je bent wéér op een Pixel gekomen, je gaat weer "+ vThrowSum + " vooruit!";
            }
            vMoreGooses = vMoreGooses + 1;
            console.log("fDisplayImage aanroepen")
            fDisplayImage();
            setTimeout(function(){fPositionGoose(vThrowSum)},vSpeed/10);
            
        }

        function fChangePlayer() {


            if (vWhichPlayer == vPlayer1) {

                vWhichPlayer = vPlayer2
                vpNarrator.innerHTML = vWhichPlayer + " is aan de beurt"
                vbThrow.disabled = false;
                vbStopGame.disabled = false;

            }
            else if (vWhichPlayer == vPlayer2) {

                vWhichPlayer = vPlayer1;
                vpNarrator.innerHTML = vWhichPlayer + " is aan de beurt"
                vbThrow.disabled = false;
                vbStopGame.disabled = false;
            }
            else return
        }
            function fDisplayImage() {
                
            var num = Math.floor(Math.random()*5);
            imgPixel.src = "./images/pixel"+num+".jpg"
            viPixel.style.visibility='visible'
            console.log("in fDisplayimage " +num)
            console.log(viPixel)
            console.log(imgPixel)
            return
            }



    </script>
</head>

<body>
    <section class="section">
        <div class="container">
            
            <div class="columns is-mobile">
            <div class="column">
                        <h1 class="title">
                        Pixelbord 
                        
                        <figure class="image is-128x128">
                        <img class="is-rounded" src="./images/pixel4.jpg">
                        </figure>  
                        </h1>
                        
                    <button id="bThrow" onclick="fThrowDice()" class="button is-primary">Gooien</button>
                    <button id="bStartGame" onclick="fStartGame()" class="button is-primary">Spel Starten</button>
                    <button id="bStopGame" onclick="fStopGame()" class="button is-danger">Spel Stoppen</button>
                    <div class="subtitle">
                        <br>
                        Speler 1: <div id=dPlayer1 class='subtitle'>0</div>
                        
                        Speler 2: <div id=dPlayer2 class='subtitle'>0</div>
                    </div>
            
                        
                   
                
                
                
            </div>
                <div class="column is-mobile">
                    <span id='dDice1' class="dice"></span>      
                    <span id='dDice2' class="dice"></span>
                    <figure id="iPixel" class="image is-16by9">
                        <img id="imgPixel" src="./images/pixel1.jpg">
                    </figure>
                    <p id="pTextStart" class="subtitle">
                        Druk op Start Spel om te beginnen.
                    </p>
                    
                </div>
       
                            


            </div>









        </div>
    </section>
</body>

</html>